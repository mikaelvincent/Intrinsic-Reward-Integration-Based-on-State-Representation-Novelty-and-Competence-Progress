##### 4.4.2.1 State Representation and Forward Model

- Learned Embedding
  - A neural network $\phi$ maps raw states $s_t$ to a compact feature vector $\phi(s_t)$. Inspired by prior works (Pathak et al., 2017; Burda et al., 2018), this embedding is updated by a dual objective:
    1. Forward Dynamics
       - Predict $\phi(s_{t+1})$ from $\phi(s_t)$ and action $a_t$.
    2. Inverse Dynamics
       - Predict $a_t$ from $\phi(s_t)$ and $\phi(s_{t+1})$.
    
    The forward model's mean-squared error $\|\phi(s_{t+1}) - \hat{\phi}(s_t,a_t)\|^2$ quantifies how accurately the environment's controllable dynamics are captured.
- Region Partitioning
  - The state-action space is recursively subdivided into local subregions.

    Each node $R_i$ stores:
    - Local model parameters or a local forward-model regressor (depending on implementation detail).
    - Averaged or running forward-model error $\overline{E}_i$.
    - Learning progress $\mathrm{LP}_i$, indicating how $\overline{E}_i$ changes over repeated training steps in that region (Baranes and Oudeyer, 2009).
